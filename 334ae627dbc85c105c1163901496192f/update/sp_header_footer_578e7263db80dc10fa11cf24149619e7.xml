<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_header_footer">
    <sp_header_footer action="INSERT_OR_UPDATE">
        <category>standard</category>
        <client_script><![CDATA[function ($rootScope, $scope, snRecordWatcher, spUtil, $location, $uibModal, cabrillo, $timeout, $window) {

	var c = this;
	$scope.collapse = function() {
		$rootScope.$emit('sp-navbar-collapse');
	}

	$scope.avatarProfile = {
		userID: $scope.user.sys_id,
		name: $scope.user.name,
		initials: $window.NOW.user_initials
	};

	if ($window.NOW.user_avatar) {
		$scope.avatarProfile.userImage = $window.NOW.user_avatar;
	}
	var a = "";

	if (cabrillo.isNative()) {
		if ($window.innerWidth < 767) {
			$scope.isViewNative = true;
		} else {
			$scope.isViewNativeTablet = true;
		}
	}

	$scope.openPopUp = function() {
		var url = "$chat_support.do?queueID=" + $scope.data.connect_support_queue_id;
		var popup = window.open (url, "popup", "width=900, height=600");
	};

	$scope.openLogin = function () {
		$scope.modalInstance = $uibModal.open({
			templateUrl: 'modalLogin',
			scope: $scope
		});
	};

	var xsScreenSize = isXSScreenSize();
	$scope.showXSAvatar = isXSScreenSize();
	$scope.showAvatar = !isXSScreenSize();

	$scope.isAgentChatConfigured = g_has_agent_chat_config;

	angular.element($window).on('resize', function () {
		if(xsScreenSize !== isXSScreenSize() && (!$scope.showXSAvatar || !$scope.showAvatar)){
			$scope.showXSAvatar = true;
			$scope.showAvatar = true;
		}
	});


	function isXSScreenSize() {
		return $window.matchMedia('(max-width: 767px)').matches;
	}

	$rootScope.$on('sp.avatar_changed', function(evt, obj) {
		$scope.userID = "";
		$scope.newAvatarId = obj.newAvatarId;
		$timeout(function(){
			$scope.userID = $scope.user.sys_id;
			$(".sub-avatar").css("background-image", 'url("' + $scope.newAvatarId + '.iix?t=small")');
		});
	});

	$scope.isHomepage = function() {
		if (!$scope.page.id)
			return true;

		if ($scope.page.id == $scope.portal.homepage_dv)
			return true;

		return false;
	};

	c.selectedSecondCategory = function(category){
		c.server.get({
			action: "selectedSecondCategory",
			category: category
		}).then(function(response) {
			for(i in c.data.categories){
				for(j in c.data.categories[i].categories){
					c.data.categories[i].categories[j].selected = false;
				}
			}
			category.selected = true;
			c.data.thirdCategories = response.data.thirdCategories;
			c.data.showThirdCategories = response.data.showThirdCategories;
			c.data.showItems = response.data.showItems;
			c.data.subcategorySelected = response.data.subcategorySelected;
			c.data.items = response.data.items;

		});
	}

	c.selectedThirdCategory = function(category){
		c.server.get({
			action: "selectedThirdCategory",
			category: category
		}).then(function(response) {
			for(i in c.data.thirdCategories){
				c.data.thirdCategories[i].selected = false;
			}
			category.selected = true;
			c.data.subcategorySelected = response.data.subcategorySelected;
			c.data.items = response.data.items;
			c.data.showItems = response.data.showItems;
		});
	}

	c.showItem = function(itemID){
		if(c.data.page_id == null || c.data.page_id == "gservice_index"){
			c.data.menuSelected = 0;
			$('.dropdown-bg').css('display', 'none');
			$rootScope.$broadcast('openSelectedCategoryItem', false, itemID);
		}
		else{
			$location.search("id=gservice_index&item_id=" + itemID);
		}

	}

	// Dropdown
	c.openDropDown = function(item){
		if(item == c.data.menuSelected && c.data.menuSelected != 2){
			c.data.menuSelected = 0;
			$('.dropdown-bg').css('display', 'none');
		}
		else{
			c.data.menuSelected = item;
			if(item == 0){
				$('.dropdown-bg').css('display', 'none');
			}
			else{
				$('.dropdown-bg').css('display', 'block');
				if(item == 2){
					$('.dropdown-bg').css('display', 'none');
					$rootScope.$broadcast('showHideWidget', "error");
				}
				else if(item == 3){
					c.data.showItems = false;
					c.data.thirdCategories = false;

					for(i in c.data.categories){
						for(j in c.data.categories[i].categories){
							c.data.categories[i].categories[j].selected = false;
						}
					}
				}
			}
		}
	}


	$scope.$on('hideSideMenu', function (event) {
		c.data.menuSelected = 0;
		$('.dropdown-bg').css('display', 'none');
	});
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.navbar {
  transition: 250ms opacity ease-in-out;
  -webkit-transition: 250ms opacity ease-in-out;
  border: 0;
  border-bottom: 4px solid $sp-navbar-divider-color;

  /* GSERVICE HEADER TEXT */
  padding-left: 10%;
  padding-top: 5%;
  font-family: $text-bold;
  transition-property: padding-top;
  transition-duration: .2s;
}

.navbar.scroll-navbar{
  padding-top: 30px;
  border-bottom: 2px solid;
}

.navbar-fade {
  opacity: 0.4;
}

.navbar-inverse .navbar-toggle {
  border-color: rgba(255, 255, 255, 0.25);
}

header[role="banner"],
.nav &gt; li &gt; a {
  max-height: 60px;
}

@media screen and (max-width: 768px){
  .nav &gt; li &gt; a {
    padding-right: 0.5rem;
    padding-left: 0.5rem;
  }
}

.navbar-brand {
  max-height: 60px;
  padding: 0;
  padding-bottom: 0.5rem;
}

.navbar-brand img, .navbar-brand span {
  margin-left: $sp-logo-margin-x;
  margin-right: $sp-logo-margin-x;
  margin-top: $sp-logo-margin-y;
  margin-bottom: $sp-logo-margin-y;
  display: block;
  max-height: $sp-logo-max-height;
  max-width: $sp-logo-max-width;
  position: relative;
  top: 50%;
  -webkit-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  transform: translateY(-50%);

  /* GSERVICE HEADER TEXT */
  font-size: 50px;
  font-family: $text-light;

  text-transform: uppercase;
  color: $deep-sky-blue;
}

/* GSERVICE HEADER TEXT */
.navbar-brand span::first-letter {
  font-family: $text-bold;
  font-weight: bold;
}

.breadcrumb-container {
  background-color: $panel-bg;
}

/* for mobile app */
.navbar-inverse.is-native {
  background-color: #405060;
}

nav {
  margin-bottom: 0px;
  border-radius: 0px;

  .toggle-dropdown {
    height: 60px;
  }

}

.navbar-right {
  padding: 15px 0 10px 7px;
//  padding-right: 0px;
//  padding-left: 7px;
}

.navbar-nav {
  margin: 0px;
}

// PRB711244: Dropdown menu is scrollable when too many items
.scrollable-dropdown {
  max-height: 80vh;
  overflow: auto;
  height: auto;
}

.is-native {
  .scrollable-dropdown {
    max-height: 100vh;
    overflow: scroll;
    height: auto;
  }
}


/* PRB923910: Fix for Service Portal - Header Poorly Aligned in Safari */
@media screen and (min-width: 768px) {
  .navbar-right {
    display: flex !important;
  }
}

/* Portal title styling */
.portal-title-initial, .portal-title-without-initial {
  display: block;
}

/* SIDEBAR STYLES */
.icon-bar {
  width: 90px; /* Set a specific width */
  position: fixed;
  left: 0;
  top: 0;
  z-index: 1;

  a {
    display: block; /* Make the links appear below each other instead of side-by-side */
    text-align: center; /* Center-align text */
    padding: 16px; /* Add some padding */
    height: 90px;
    margin-bottom: 5px;
  }
  a:first-child {
    height: 136px;
    background-color: $deep-sky-blue;
    padding: 0;
    display: flex;
    align-items: flex-end;

    img {
      width: 90px;
      height: 90px;
    }
  }
}

.first-item {
  background-image: url('GService_StyleGuide_V1_AR_GSERVICE.png');  
  background-size: 90px 130px;
  border: 0;
  background-repeat: no-repeat;
}
.second-item {
  background-image: url('GService_StyleGuide_V1_AR_ERRO.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}
.third-item {
  background-image: url('GService_StyleGuide_V1_AR_SERVICO.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}
.forth-item {
  background-image: url('GService_StyleGuide_V1_AR_AUTO.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}
.fifth-item {
  background-image: url('GService_StyleGuide_V1_AR_DUVIDAS.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}
.sixth-item {
  background-image: url('GService_StyleGuide_V1_AR_PORTAL.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}
.seventh-item {
  background-image: url('GService_StyleGuide_V1_AR_INDISPONIVEL.png');  
  background-size: 90px 90px;
  background-repeat: no-repeat;
}

// Dropdown
.dropdown-bg {
  display: none;
  position: fixed;
  z-index: 11;
  left: 90px;
  width: 100%;
  height: 100%;
  background-color: black;
  opacity: .5;
  cursor: default;
}
.dropdown-third-item {
  padding: 40px 40px 40px 30px;
  background-color: rgba(255,255,255,.95);
  position: fixed;
  z-index: 12;
  top: 90px;
  left: 90px;
  color: $slate-gray;
  font-weight: bold;
  display: flex;
  align-items: flex-start;
  height: calc(100% - 180px);
  overflow: auto;

  .dropdown-column {
    margin-left: 20px;
    padding-left: 20px;
    margin-right: 10px;
    border-left: 2px solid $dodger-blue;

    &amp;:first-child {
      margin-left: 0;
      padding-left: 0;
      border: 0;
    }
    &amp;:last-child { margin-right: 0; }

    .category-subcategory {
      margin-top: 15px;
      &amp;:first-child { margin-top: 0; }

      .category {
        font-size: 16px;
        color: $dodger-blue; //OR $deep-sky-blue
        text-transform: uppercase;
        margin-bottom: 5px;

      }
    }
    .subcategory {
      &amp;:hover {
        color: $dodger-blue;
      }
    }

    .category-selected {
      color: $dodger-blue;
    }

  }
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>gservice_stock_header</id>
        <internal>false</internal>
        <link><![CDATA[function(scope, element) {
	$(document).keyup(function(event) {
		if (event.which == 9 || event.which == 37 || event.which == 39) { //tab key handler + arrow keys
			if ($(event.target).parents(".dropdown-menu").length == 0) { //if we are NOT inside a dropdown...
				//close the dropdowns
				$(".dropdown").removeClass("open");
				$("[data-toggle='dropdown']").attr("aria-expanded", "false");
			}
		}
	});

	$(element).on('click.nav','.navbar-collapse.in',function(e) {
		var target = $(e.target);
		if (target.is('a')) {
			if (target.hasClass('sp-menu-has-items'))
				return; // menu item has a submenu, so just toggle it

			// collapse mobile nav if clicked an anchor
			$(this).removeClass('in').addClass('collapse');
			return;
		}

		if (target.parent().hasClass("toggle-dropdown")) {
			// collapse mobile nav if parent has toggle-dropdown class
			$(this).removeClass('in').addClass('collapse');
			return;
		}

		// if neither target nor parent is an anchor, do nothing
		if (!target.parent().is('a'))
			return;

		// collapse mobile nav if target is part of a submenu
		if (target.parents("ul.dropdown-menu").length > 0)
			$(this).removeClass('in').addClass('collapse');
	});
	
	$(document).on("wheel", ".sp-scroll", function(event){
		$("#header-navbar").addClass("scroll-navbar");
		if(event.originalEvent.deltaY > 0)
			$("#header-navbar").addClass("scroll-navbar");	
		
		if($(".sp-scroll").scrollTop() < 100)
			$("#header-navbar").removeClass("scroll-navbar");	
		
	});
}]]></link>
        <name>GService Stock Header</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[// Defines the support queue ID that will be linked to by the Live Chat link in header
(function() {
	var localInput = input;
	var portalUtils = new global.OCLPortalUtils();

	data.menuSelected = 0;
	data.page_id = $sp.getParameter("id");

	data.connect_support_queue_id = $sp.getValue('sp_chat_queue');
	data.login_page = $sp.getValue('login_page');
	data.profileBtnMsg = gs.getMessage("User options");
	var menu = $sp.getValue("sp_rectangle_menu");
	data.menu = $sp.getWidgetFromInstance(menu);
	if (data.menu && data.menu.data) {
		data.menu.data.replace = true;
		// Hide login if menu already has link to login
		data.hasLogin = false;
		if (data.menu.data.menu.items) {
			for(var i in data.menu.data.menu.items) {
				var item = data.menu.data.menu.items[i];
				if (item.type == 'page' && item.sp_page == data.login_page)
					data.hasLogin = true;
			}
		}
	}

	data.loginWidget = $sp.getWidgetFromInstance('login-modal');

	//Menu "Reporte um erro"

	/////////////////////////////////////////////////////////////////////////////////////////////////

	//Menu "Solicite um serviço"

	var categories = gs.getProperty("gservice_categories").split(",");
	var query = "";
	for (i in categories){
		if(query == ""){
			query = "sys_id=" + categories[i];
		}
		else{
			query+= "^ORsys_id=" + categories[i];
		}
	}
	data.categories = [];
	var grCategories = new GlideRecord("sc_category");
	grCategories.addEncodedQuery(query);
	grCategories.orderBy('order');
	grCategories.query();
	while(grCategories.next()){
		var jsonCategory = {title : grCategories.getValue("title"),
												sys_id : grCategories.getUniqueValue(),
												categories : []};
		data.categories.push(jsonCategory);
	}

	for(i in data.categories){
		var grSecondCategories = new GlideRecord("sc_category");
		grSecondCategories.addQuery("parent", data.categories[i].sys_id);
		grSecondCategories.query();
		while(grSecondCategories.next()){
			var jsonSecondCategories = {title : grSecondCategories.getValue("title"),
																	sys_id : grSecondCategories.getUniqueValue(),
																	parent : "",
																	selected : false};
			data.categories[i].categories.push(jsonSecondCategories);
		}
	}

	if(localInput && localInput.action == "selectedSecondCategory"){
		data.thirdCategories = portalUtils.getSubcategories(localInput.category.sys_id, localInput.category.title);

		if(data.thirdCategories.length != 0){
			data.showThirdCategories = true;
			data.showItems = false;
		}
		else{
			data.showThirdCategories = false;
			data.subcategorySelected = true;
			data.items = portalUtils.getItems(localInput.category.sys_id);
			if(data.items.length > 0){
				data.showItems = true;
			}
		}
	}

	if(localInput && localInput.action == "selectedThirdCategory"){
		data.subcategorySelected = true;
		data.items = portalUtils.getItems(localInput.category.sys_id);
		if(data.items.length > 0){
			data.showItems = true;
		}
	}
	/////////////////////////////////////////////////////////////////////////////////////////////////
})()]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_header_footer</sys_class_name>
        <sys_created_by>organize.vinicius.oliveira</sys_created_by>
        <sys_created_on>2020-04-14 18:00:53</sys_created_on>
        <sys_id>578e7263db80dc10fa11cf24149619e7</sys_id>
        <sys_mod_count>421</sys_mod_count>
        <sys_name>GService Stock Header</sys_name>
        <sys_package display_value="ITSM Service Portal" source="x_gmeps_itsm_servi">334ae627dbc85c105c1163901496192f</sys_package>
        <sys_policy/>
        <sys_scope display_value="ITSM Service Portal">334ae627dbc85c105c1163901496192f</sys_scope>
        <sys_update_name>sp_header_footer_578e7263db80dc10fa11cf24149619e7</sys_update_name>
        <sys_updated_by>organize.jorge.garcia</sys_updated_by>
        <sys_updated_on>2020-05-16 20:38:27</sys_updated_on>
        <template><![CDATA[<div>
  
  <!-- SIDE BAR -->
  <div class="icon-bar">   
    <a href="?id=gservice_index" class="">
      <img src="GService_StyleGuide_V1_AR_GSERVICE.png" />
    </a>
    <a href="#" class="second-item" ng-click="c.openDropDown(2)"></a>
    <a href="#" class="third-item" ng-click="c.openDropDown(3)"></a>
    <a href="#" class="forth-item" ng-click="c.openDropDown(4)"></a>
    <a href="#" class="fifth-item" ng-click="c.openDropDown(5)"></a>
    <a href="#" class="sixth-item" ng-click="c.openDropDown(6)"></a>
    <a href="#" class="seventh-item" ng-click="c.openDropDown(7)"></a>    
  </div>

  <div class="dropdown-bg" ng-click="c.openDropDown(0)"></div>
  
  <!-- Reporte um erro -->
  <div>
    <widget id="gservice_error_modal"></widget>
  </div>
  
  <!-- Solicite um serviço -->
  
  <div class="dropdown-third-item" ng-if="c.data.menuSelected == 3">
    <div class="dropdown-column">
      <div class="category-subcategory" ng-repeat="category in data.categories">
        <div class="category">{{category.title}}</div>
        <div ng-repeat="secCategory in category.categories">
          <div ng-class="secCategory.selected ? 'category-selected' : 'subcategory'" ng-click="c.selectedSecondCategory(secCategory)">{{secCategory.title}}</div>
        </div>
      </div>
    </div>

    <div class="dropdown-column dropdown-column2" ng-if="data.thirdCategories">
      <div ng-repeat="thirdCategory in data.thirdCategories">
        <div ng-class="thirdCategory.selected ? 'category-selected' : 'subcategory'" ng-click="c.selectedThirdCategory(thirdCategory)">{{thirdCategory.title}}</div>
      </div>
    </div>
    
    <div class="dropdown-column dropdown-column2" ng-if="data.showItems">
      <div ng-repeat="item in data.items">
        <div class="subcategory" ng-click="c.showItem(item.sys_id)">{{item.title}}</div>
      </div>
    </div>
  </div>

  <!-- NAV -->
  <nav id="header-navbar" class="navbar-inverse" ng-class="::{'navbar':!isViewNative, 'is-native': isViewNative}"role="navigation">
    <div ng-show="::!isViewNative" class="navbar-header">

      <a class="navbar-brand" ng-if="::!portal.logo" href="?id={{::portal.homepage_dv}}">
        <span ng-bind="portal.title"></span>
      </a>

      <a class="navbar-brand navbar-brand-logo" ng-if="::portal.logo" ng-href="?id={{::portal.homepage_dv}}" ng-click="collapse()" aria-label="${Go to homepage}">
        <img ng-src="{{::portal.logo}}" title="ServiceNow" role="presentation" alt="${Portal Logo}" />
      </a>

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sp-nav-bar">
        <span class="sr-only">${Toggle navigation}</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <div sp-navbar-toggle="" class="collapse navbar-right" id="sp-nav-bar">
      <!-- Include The Menu -->
      <sp-widget widget="::data.menu"></sp-widget>
      <ul ng-if="(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)" class="nav navbar-nav" role="presentation">
        <li role="presentation"><a href ng-click="::openLogin()">${Login}</a></li>
      </ul>
      <ul ng-if="user.logged_in" class="nav navbar-nav" role="menubar">
        
        <!-- chat, avatar, and logout -->
        <li ng-if="::(data.connect_support_queue_id && !isAgentChatConfigured)" role="presentation"><a href ng-click="openPopUp()" role="menuitem">${Live Chat}</a></li>

        <!-- ** THIS SECTION IS HIDDEN SO THAT THE USER AVATAR IS NOT DISPLAYED IN THE HEADER BAR ** -->
        <!--<li ng-if="showAvatar" class="hidden-xs dropdown" role="presentation">
<a href class="toggle-dropdown" data-toggle="dropdown" aria-expanded="false" title="{{::data.profileBtnMsg}}" aria-label="{{::data.profileBtnMsg}}: {{::user.name}}" id="profile-dropdown"  role="menuitem" aria-haspopup="true">
<span class="navbar-avatar" aria-hidden="true"><sn-avatar class="avatar-small-medium" primary="avatarProfile" /></span>
<span class="visible-lg-inline">{{::user.name}}</span>
</a>
<ul class="dropdown-menu" role="menu" aria-label="{{::data.profileBtnMsg}}">
<li role="presentation"><a tabindex="-1" ng-href="?id=user_profile&sys_id={{::user.sys_id}}" role="menuitem">${Profile}</a></li>
<li ng-if="::!(isViewNative || isViewNativeTablet)" role="presentation"><a tabindex="-1" href="{{::portal.logoutUrl}}" role="menuitem">${Logout}</a></li>
</ul>
</li>
-->

        <li ng-if="showXSAvatar" class="visible-xs-block" role="presentation"><a role="menuitem" ng-href="?id=user_profile&sys_id={{::user.sys_id}}" ng-click="collapse()">
          <span class="navbar-avatar"><sn-avatar class="avatar-small-medium" primary="avatarProfile" /></span>{{::user.name}}</a>
        </li>
        <li ng-if="::!(isViewNative || isViewNativeTablet)" class="visible-xs-block" role="presentation"><a role="menuitem" ng-href="{{::portal.logoutUrl}}" ng-click="collapse()">${Logout}</a></li>
      </ul>
    </div>
  </nav>
  
</div>]]></template>
    </sp_header_footer>
</record_update>
