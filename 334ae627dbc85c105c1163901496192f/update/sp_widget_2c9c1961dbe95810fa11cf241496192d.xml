<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($timeout, $scope, $rootScope) {
	var c = this;
	c.isLoading = true;

	$scope.$on('sp_loading_indicator', function(e, value) {
		if($scope.loadingIndicator && !value){
			c.isLoading = false;
		}
		$scope.loadingIndicator = value;
	});

	c.openReport = function(report_id){
		c.isLoading = true;
		c.server.get({
			action: "openReport",
			report_id: report_id
		}).then(function(response) {
			c.data.gservice_report = response.data.gservice_report;
			c.data.report = response.data.report;
			c.data.showReport = true;
		});

	}

	c.orderBy = function(column){
		for(var i in c.data.columns){
			if(column.name == c.data.columns[i].name){
				if(column.direction == 0){
					column.direction = 1;
				}
				else{
					column.direction = -column.direction;
				}
			}
			else
				c.data.columns[i].direction = 0;
		}
		c.server.get({
			action: "sort",
			reports: c.data.reports,
			column: column
		}).then(function(response) {
			c.data.reports = response.data.reports;
		});
	}

	$scope.$on('returnReport', function (event) {
		c.isLoading = true;
		c.server.update();
	});

	c.columnDirection = function(direction){
		var style = "";
		if(direction == -1){
			style = "";
		}
		else if(direction == 0){
			style = "";
		}
		else {
			style = "";
		}
		return style;
	}

	$scope.$on('getSearchedItemsReport', function (event, query) {
		c.server.get({
			action: "searchReport",
			query: query
		}).then(function(response) {
			c.data.reports = response.data.reports;
		});
	});

	$scope.$on('getSearchedItemsReportClear', function (event, query) {
		c.isLoading = true;
		c.server.update();
	});

}]]></client_script>
        <controller_as>c</controller_as>
        <css>.content {
  background-color: white;
  padding: 20px 0;
}

.content_search {
  width: 300px;
  margin: 10px 0;
  margin-bottom: 20px;
  background-color: white;
}

.content_reportlist {

  .alert-info {
    font-size: 18px;
    color: $slate-gray;
    background-color: white;
    border: 0;
    border-top: 2px solid $slate-gray;
    border-bottom: 2px solid $slate-gray;
    margin-top: 20px;
  }

  table {
    table-layout: fixed;
    width: 100%;

    thead {
      color: $deep-sky-blue;
      text-transform: uppercase;
      font-family: $text-bolder;

      th {
        padding: 10px 0;
        border: 0;

        img {
          transition: .4s ease-in-out;
          margin-left: 10px;
          width: 18px;
        }

        .invert-arrow {
          transform: rotate(180deg);
        }
      }
      th:nth-child(1) {
        width: 10%;
      }
      th:nth-child(2) {
        width: 90%;
      }
    }

    tbody {
      td {
        padding: 2px 0;
      }
      .report_type {
        font-size: 12px;
      }
      img {
        height: 33px;
        margin-right: 3px;
      }
      .report_title {
        transition: .2s ease-in-out;
        text-decoration: underline;
        font-family: $text-bold;

        &amp;:hover {
          color: $deep-sky-blue;
        }
      }
    }
  }
}

.report-widget-wrap {
  background:#fff;
  padding:15px;
  margin: 0 0 15px 0;
}

.report-widget-title {
  padding:0 0 15px;
  font-weight:bold;
  font-size: 14px;
  margin-top: 0;
  margin-bottom: 0;
}

.highcharts-container {
  width: 100% !important;
  .highcharts-root {
    width: 100% !important;
  }
}

.highcharts-container g.highcharts-button *,
.highcharts-container image.hc-image {
  transition: fill-opacity 0.3s linear, stroke-opacity 0.3s linear, opacity 0.3s linear;
  fill-opacity: 0;
  stroke-opacity: 0;
  opacity:0;
}

.highcharts-container:hover g.highcharts-button *,
.highcharts-container:hover image.hc-image {
  fill-opacity: 1;
  stroke-opacity: 1;
  opacity:1;
}

.highcharts-legend-item span::after,
.highcharts-legend-item::after {
  content: "\200E";
}

table.wide .pivot_cell,
table.wide .pivot_caption,
table.wide .pivot_caption_dark {
  padding: 3px 5px;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>gservice_report_list</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>GService Report List</name>
        <option_schema>[{"displayValue":"Report","name":"report_id","label":"Report","type":"reference","value":"sys_report","ed":{"reference":"sys_report"}},{"hint":"","name":"show_title","default_value":"true","label":"Show title","type":"boolean"}]</option_schema>
        <public>true</public>
        <roles/>
        <script><![CDATA[(function() {
	var localInput = input;
	var reportUtils = new global.OCLPortalReportUtils();
	var portalUtils = new global.OCLPortalUtils();
	data.report_options = {"report_id": "",
												 "show_title" : true};
	data.gservice_report = $sp.getWidget('gservice_report', data.report_options);

	data.reports = reportUtils.getReportList();
	data.columns = [];
	var columns = gs.getProperty("gservice_report_columns").split("|");
	for(var i in columns){
		data.columns.push(JSON.parse(columns[i]));
	}
	//data.columns = columns;
	data.showReport = false;
	data.report_options = {"report_id": '', "show_title" : "true"};

	if (options.height) {
		data.height = options.height +"px";
	} else {
		data.height = "700px";
	}

	var typeahead_search_options = {"contextual_search_sources": data.search_property, "limit": 5, 
																	"broadcast_name" : "getSearchedItemsReport",
																	"category_color" : "",
																	"category_bg_color" : "",
																	"category_bd_color" : ""
																 };

	data.gserviceTypeahead = $sp.getWidget('gservice_typeahead_search', typeahead_search_options);

	if(localInput){
		switch(localInput.action){
			case "openReport":
				var report_options = {"report_id": localInput.report_id,
															"show_title" : true};
				data.gservice_report = $sp.getWidget('gservice_report', report_options);
				break;
			case "sort":
				data.reports = portalUtils.sortList(localInput.reports, localInput.column.order, localInput.column.direction);
				break;
			case "searchReport":
				data.reports = reportUtils.getReportList(localInput.query);
				break;
		}
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>organize.fernando</sys_created_by>
        <sys_created_on>2020-06-21 19:19:07</sys_created_on>
        <sys_id>2c9c1961dbe95810fa11cf241496192d</sys_id>
        <sys_mod_count>240</sys_mod_count>
        <sys_name>GService Report List</sys_name>
        <sys_package display_value="ITSM Service Portal" source="x_gmeps_itsm_servi">334ae627dbc85c105c1163901496192f</sys_package>
        <sys_policy/>
        <sys_scope display_value="ITSM Service Portal">334ae627dbc85c105c1163901496192f</sys_scope>
        <sys_update_name>sp_widget_2c9c1961dbe95810fa11cf241496192d</sys_update_name>
        <sys_updated_by>organize.jorge.garcia</sys_updated_by>
        <sys_updated_on>2020-08-01 13:52:54</sys_updated_on>
        <template><![CDATA[<div class="content_reportlist" ng-if="!data.showReport">

  <div class="header-loader" ng-show="c.isLoading">
    <div class="hidden-xs sp-loading-indicator" ng-if="loadingIndicator">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>

  <div ng-show="!c.isLoading">
    <div class="content_search filter-padding">
      <sp-widget widget="data.gserviceTypeahead"></sp-widget>
    </div>
    <div>
      <div class="alert alert-info" ng-if="data.reports.length == 0">
        ${Ops! NÃ£o encontramos resultados para essa busca.}
      </div>
      <table ng-if="data.reports.length != 0">
        <thead id="list-columns">
          <tr>
            <th ng-repeat="column in data.columns">
              <div ng-click="c.orderBy(column)">
                {{column.name}}
                <span ng-if="column.order">
                  <span ng-if="!column.direction"></span>
                  <span ng-if="column.direction"><img src="GService_Seta_PD_Transparent.png" ng-class="{'invert-arrow': column.direction == 1}"/></span>
                </span>
              </div>
            </th>
          </tr>
        </thead>
        <tbody ng-show="!c.isLoading" ng-repeat="report in data.reports">
          <tr>
            <td class="report_type">
              <img src="{{report.img}}"/>
            </td>
            <td>
              <div class="report_title" ng-click="c.openReport(report.sys_id)">{{report.title}}</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div id="report-item" ng-if="data.showReport">
  <sp-widget widget="data.gservice_report"></sp-widget>
</div>]]></template>
    </sp_widget>
</record_update>
