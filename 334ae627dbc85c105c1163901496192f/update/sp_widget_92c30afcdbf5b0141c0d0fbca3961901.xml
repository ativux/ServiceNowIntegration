<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($scope, spUtil, $rootScope) {
    /* widget controller */

    var c = this;

    c.item_number = $scope.$parent.item.number;
    $scope.feedback = false;

    $scope.data.inputSurvey = "";
    $scope.surveyResposta = 5;
    $scope.showButton = false;
    $scope.sysID = $scope.$parent.item.sys_id;

    $scope.surveyResponse = function(resposta) {
        $scope.surveyResposta = resposta;
        $scope.showButton = true;
    };

    $scope.sendSurvey = function() {
        $scope.data.action = "survey";
        var objResponse = {
            "qdtStars": $scope.surveyResposta,
            "justification": $scope.data.inputSurvey,
            "taskSysId": $scope.sysID
        };

        $scope.feedback = true;

        c.data.objSurveyResponse = objResponse;
        c.data.action = 'respostaSurvey';

        c.server.update().then(function() {});
			  $scope.data.inputSurvey = "";
    };

};]]></client_script>
        <controller_as>c</controller_as>
        <css>.feed{&#13;
    color:#33ccff;&#13;
    width:200px;&#13;
}&#13;
.rate {&#13;
    float: left;&#13;
}&#13;
.rate:not(:checked) &gt; input {&#13;
    position:absolute;&#13;
    top:-9999px;&#13;
  	visibility: hidden;&#13;
}&#13;
.rate:not(:checked) &gt; label {&#13;
    float:right;&#13;
    width:1em;&#13;
    overflow:hidden;&#13;
    white-space:nowrap;&#13;
    cursor:pointer;&#13;
    font-size:30px;&#13;
    color:#ccc;&#13;
}&#13;
.rate:not(:checked) &gt; label:before {&#13;
    content: '★ ';&#13;
}&#13;
.rate &gt; input:checked ~ label {&#13;
    color: #ffc700;    &#13;
}&#13;
.rate:not(:checked) &gt; label:hover,&#13;
.rate:not(:checked) &gt; label:hover ~ label {&#13;
    color: #deb217;  &#13;
}&#13;
.rate &gt; input:checked + label:hover,&#13;
.rate &gt; input:checked + label:hover ~ label,&#13;
.rate &gt; input:checked ~ label:hover,&#13;
.rate &gt; input:checked ~ label:hover ~ label,&#13;
.rate &gt; label:hover ~ input:checked ~ label {&#13;
    color: #c59b08;&#13;
}&#13;
&#13;
.container{&#13;
  width:inherit;&#13;
  height:100%;&#13;
  margin-left: 0;&#13;
  min-width: 250px;&#13;
  display:flex;&#13;
  flex-direction:column;&#13;
  .rate{&#13;
  	display:flex;&#13;
    flex-direction: row-reverse;&#13;
    //justify-content:center;&#13;
    justify-content: flex-end&#13;
  }&#13;
  .options{&#13;
    display:flex;&#13;
    justify-content:center;&#13;
    flex-direction:column;&#13;
    textarea{&#13;
      margin-top:10px;&#13;
    	resize: none;&#13;
      border: solid #33ccff 1px;&#13;
    }&#13;
    .closing {&#13;
      border:none;&#13;
      background: none;&#13;
      width:100%;&#13;
      display:flex;&#13;
      justify-content:left;&#13;
      padding:10px 0;&#13;
      align-items:center;&#13;
      font-size:1.7rem;&#13;
      img{&#13;
        width:120px;&#13;
       }&#13;
    }  &#13;
    .icone{&#13;
      img{&#13;
        width:35px;&#13;
        height:35px;&#13;
        margin-right:5px;&#13;
      }   &#13;
    }&#13;
  }&#13;
}&#13;
&#13;
</css>
        <data_table>sp_instance</data_table>
        <demo_data>{
	"options":{
		"task_sys_id":"3472061adb4278101c0d0fbca39619cd",
		"table":"sc_req_item"	
	}	
}</demo_data>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>rating_stars_survey</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Rating stars survey</name>
        <option_schema>[{"name":"task_sys_id","section":"Data","label":"task_sys_id","type":"string"},{"name":"table","section":"other","label":"table","type":"string"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
    var localInput = input;
	data.objSurveyResponse = '';
    var surveyUtils = new global.SurveyUtils();
    if (localInput) {
        if (localInput.action == "respostaSurvey") {
            surveyUtils.getInstance(localInput.objSurveyResponse);
        }
    }

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>glorusso</sys_created_by>
        <sys_created_on>2021-08-03 16:53:01</sys_created_on>
        <sys_id>92c30afcdbf5b0141c0d0fbca3961901</sys_id>
        <sys_mod_count>189</sys_mod_count>
        <sys_name>Rating stars survey</sys_name>
        <sys_package display_value="ITSM Service Portal" source="x_gmeps_itsm_servi">334ae627dbc85c105c1163901496192f</sys_package>
        <sys_policy/>
        <sys_scope display_value="ITSM Service Portal">334ae627dbc85c105c1163901496192f</sys_scope>
        <sys_update_name>sp_widget_92c30afcdbf5b0141c0d0fbca3961901</sys_update_name>
        <sys_updated_by>glorusso</sys_updated_by>
        <sys_updated_on>2021-09-01 13:12:46</sys_updated_on>
        <template><![CDATA[<div class="container">
  <div class="rate" id="{{c.item_number + '-stars'}}" ng-if='feedback == false'>
    <input type="radio" id="{{c.item_number + '-star5'}}" name="{{c.item_number + '-rate'}}" value="5" ng-click="surveyResponse('5')" />
    <label for="{{c.item_number + '-star5'}}" title="5">★ stars</label>

    <input type="radio" id="{{c.item_number + '-star4'}}" name="{{c.item_number + '-rate'}}" value="4" ng-click="surveyResponse('4')" />
    <label for="{{c.item_number + '-star4'}}" title="4">★ stars</label>

    <input type="radio" id="{{c.item_number + '-star3'}}" name="{{c.item_number + '-rate'}}" value="3" ng-click="surveyResponse('3')" />
    <label for="{{c.item_number + '-star3'}}" title="3">★ stars</label>

    <input type="radio" id="{{c.item_number + '-star2'}}" name="{{c.item_number + '-rate'}}" value="2" ng-click="surveyResponse('2')" />
    <label for="{{c.item_number + '-star2'}}" title="2">★ stars</label>

    <input type="radio" id="{{c.item_number + '-star1'}}" name="{{c.item_number + '-rate'}}" value="1" ng-click="surveyResponse('1')" />
    <label for="{{c.item_number + '-star1'}}" title="1">★ star</label>
  </div>
  <div class="options">
    <div id="{{c.item_number + '-msgMelhorar'}}" ng-if="surveyResposta <= '3' && feedback == false" class="icone">
      <img src="Comentario_dashboard.png" />
      O que acha que poderia melhorar?
    </div>

    <textarea id="{{c.item_number + '-surveyJustification'}}" ng-model="data.inputSurvey" ng-if="surveyResposta <= '3' && feedback == false" rows="4"
      cols="30"></textarea>
    <button ng-if="showButton == true && feedback == false" id="{{c.item_number + '-close'}}" class="closing" ng-click="sendSurvey()"> <img
        src="Botao_Enviar_Dashboard.png" /></button>
  </div>
</div>
<div id="{{c.item_number + '-msgFeedback'}}" ng-if="feedback == true" class="feed"> 
     Recebemos o seu feedback!
     Muito obrigado
    </div>]]></template>
    </sp_widget>
</record_update>
