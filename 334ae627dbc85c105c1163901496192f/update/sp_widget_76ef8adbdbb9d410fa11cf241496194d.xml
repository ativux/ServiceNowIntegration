<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, $rootScope) {
	var c = this;
		
	var input = {};	

	c.applyFilter = function(filter, type){

		if(type == "areaFilter"){
			for(var i in c.data.filters.areaFilter){
				if(c.data.filters.areaFilter[i].name == filter.name){
					c.data.filters.areaFilter[i].selected	= c.data.filters.areaFilter[i].name;					
				}	else{
					c.data.filters.areaFilter[i].selected = false;
				}
			}
		}
		else if(type == "statusFilter"){
			for(var i in c.data.filters.statusFilter){
				if(c.data.filters.statusFilter[i].name == filter.name){
					c.data.filters.statusFilter[i].selected	= c.data.filters.statusFilter[i].name;
					} else{
					c.data.filters.statusFilter[i].selected = false;
				}
			}
		}
		else if(type == "pontoDeColetaFilter"){
			for(var i in c.data.filters.pontoDeColetaFilter){
				if(c.data.filters.pontoDeColetaFilter[i].name == filter.name){
					c.data.filters.pontoDeColetaFilter[i].selected	= c.data.filters.pontoDeColetaFilter[i].name;
				}	else{
					c.data.filters.pontoDeColetaFilter[i].selected = false;
				}
			}
		}
		else{
			for(var i in c.data.filters.locationFilter){
				if(c.data.filters.locationFilter[i].name == filter.name){
					c.data.filters.locationFilter[i].selected	= c.data.filters.locationFilter[i].name;
					c.data.pontosDeColetaAux[0].sys_id = "";
					c.populatePontosDeColeta(c.data.filters.locationFilter[i].name);
				}	else{
					c.data.filters.locationFilter[i].selected = false;
				}
			}
		}
			$rootScope.$broadcast('clearAllFilters');
			$rootScope.$broadcast('applyEquipmentFilter', c.data.filters);
	}
	
		c.statusFilterHide = function(area){
			if(area.name == "Suporte"){
				c.data.filters.statusFilter = c.data.supportStatus
			 }
			else if(area.name == "Operação"){
				c.data.filters.statusFilter = c.data.operationStatus
				
			}
	}
	
	c.areaFilterState = function(){
		c.data.showAreaFilter = !c.data.showAreaFilter;
	}
	
	c.pontoDeColetaFilter = function(){
		c.data.showPontoDeColetaFilter = !c.data.showPontoDeColetaFilter;
	}
	
	c.locationFilterState = function(){
		c.data.showLocationFilter = !c.data.showLocationFilter;
	}
	
	c.statusFilterState = function(){
		c.data.showStatusFilter = !c.data.showStatusFilter;
	}
	
	c.populatePontosDeColeta = function(parent){
		var arr = [];
		for(var i in c.data.pontosDeColetaAux){
			if(c.data.pontosDeColetaAux[i].parent.includes(parent)){
				c.data.pontosDeColetaAux[0].sys_id += c.data.pontosDeColetaAux[i].sys_id + ",";
				arr.push(c.data.pontosDeColetaAux[i]);
			}
		}
		c.data.filters.pontoDeColetaFilter = arr;
	}
		
	c.data.filters.locationFilter.map(function(item){
		if(item.selected == true){
			 c.populatePontosDeColeta(item.name);
			$rootScope.$broadcast('applyEquipmentFilter', c.data.filters);
		}
	});
		
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.content_list {
  margin-top: 20px;
  margin-bottom: 20px;
  padding-left: 0 !important;
	display: flex;


  .filter-click-size {
    transition: .4s ease-in-out;
    width: 120px;
    height: 30px;
    margin-bottom: 20px;
  }

  .title {
    color: $blue;
    font-size: 14px;
    font-family: $text-bolder;
    text-transform: uppercase;
    line-height: 1;
    margin-bottom: 15px !important;

    .break-line-other {
      transition: .4s ease-in-out;
      width: 60px;
    }
  }

  .break-line-filter {
    width: 80px;
  }
  .filter_location {
    .break-line-filter {
      width: 100px;
    }
  }

  .mask_filter {
    overflow: hidden;

    .content_filters {
      transition: .5s ease-in-out;
    }
    .filter_open {
      margin-top: 0;
    }
    .filter_close {
      margin-top: -260px;
    }
  }

  .area_filter {
    transition: .1s ease-in-out;
    cursor: pointer;
    display: flex;

    input[type="checkbox"]{
      display: none;
    }
    
    &amp;:hover {
      transition: .1s ease-in-out;
      opacity: .6;
    }

    .new-radio {
      height: 16px;
      width: 16px;
      border-radius: 50%;
      border: 2px solid #737373;
      display: block;
      position: absolute;
      left: 0;
      top: 4px;
    }
    .radio-after {
      content: "";
      height: 10px;
      width: 10px;
      display: block;
      position: absolute;
      left: 1px;
      top: 1px;
      border-radius: 50%;
      background-color: $blue;
    }
    .filter_name {
      margin-left: 25px;
      margin-top: 4px;
      margin-bottom: -6px;
      font-size: 12px;
      font-family: $text-bold;
    }
  }

  .arrow-size {
    transition: .4s ease-in-out;
    height: 10px;
    position: relative;
    top: -34px;
    left: 100px;
  }
  .invert-arrow {
    transform: rotate(180deg);
  }
  .filter_location {
    .arrow-size {
      left: 120px;
    }
  }

  .confirm_button {
    transition: .4s ease-in-out;
    font-size: 12px;
    color: $blue;
    font-family: $text-bolder;
    text-decoration: underline;
    text-transform: uppercase;
    margin-left: 30px;
    padding-top: 10px !important;
  }

  .radio-properties {
    position: relative;
    display: inline-block;
    padding-bottom: 5px;
  }

  .list-properties {
    padding-left: 0 !important;
    margin-bottom: -8px;
  }

  .detail_search {
    margin-top: -30px;
    margin-right: 60px;
  }

  .filter-click-size, .break-line-other {
    &amp;:hover {
      transition: .2s ease-in-out;
      transform: scale(1.1);
      -webkit-transform: scale(1.1);
      -ms-transform: scale(1.1);
      -moz-transform: scale(1.1);
      -o-transform: scale(1.1);
    }
  }
  
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>gservice_equipment_filter</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>GService Equipment Filter</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
    var localInput = input;
    var portalUtils = new global.OCLPortalEquipmentsUtil();

    data.filters = {
        areaFilter: [],
        locationFilter: [],
        statusFilter: [],
        pontoDeColetaFilter: []
    };
	
    data.showAreaFilter = true;
    data.showLocationFilter = true;
    data.showStatusFilter = true;
    data.showPontoDeColetaFilter = true;

    data.areaFilterTitle = gs.getMessage("Filtrar por área").toUpperCase();
    data.filters.areaFilter = portalUtils.getAreaFilter();

    data.locationFilterTitle = gs.getMessage("Filtrar por localidade").toUpperCase();
    data.filters.locationFilter = portalUtils.getLocationFilter();
	
    data.pontoDeColetaFilterTitle = gs.getMessage("Filtrar por ponto de coleta").toUpperCase();
		data.pontosDeColetaAux = portalUtils.getPontoDeColetaFilter();
		
		var arr = [];

		for(var i in data.filters.locationFilter){
			if(data.filters.locationFilter[i].selected != false){
				for(var z in data.pontosDeColetaAux){
					if(data.pontosDeColetaAux[z].parent.includes(data.filters.locationFilter[i].name)){
						
						arr.push(data.pontosDeColetaAux[z]);
						arr[0].sys_id += data.pontosDeColetaAux[z].sys_id + ",";
					}
				}
			}
		}

		data.filters.pontoDeColetaFilter = arr;
	
    data.statusFilterTitle = gs.getMessage("Filtrar por Status").toUpperCase();
    data.supportStatus = [];
    data.operationStatus = [];

    for (var i in portalUtils.getStatusFilter()) {
        if (portalUtils.getStatusFilter()[i].type.includes("Suporte")) {
            data.supportStatus.push(portalUtils.getStatusFilter()[i]);
        }
        if (portalUtils.getStatusFilter()[i].type.includes("Operação")) {
            data.operationStatus.push(portalUtils.getStatusFilter()[i]);
        }
    }

    data.filters.statusFilter = data.operationStatus;

    var typeahead_search_options = {
        "contextual_search_sources": gs.getProperty("gservice_category_search_source"),
        "limit": 5,
        "broadcast_name": "getSearchedItemsFilter",
        "category_color": "",
        "category_bg_color": "",
        "category_bd_color": "",
        "category_search_img": "gservice_mini_search_equipment_dashboard.png"
    };

    data.typeaheadWidget = $sp.getWidget('gservice_typeahead_search', typeahead_search_options);


})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>organize.fernando</sys_created_by>
        <sys_created_on>2020-07-09 19:48:31</sys_created_on>
        <sys_id>76ef8adbdbb9d410fa11cf241496194d</sys_id>
        <sys_mod_count>283</sys_mod_count>
        <sys_name>GService Equipment Filter</sys_name>
        <sys_package display_value="ITSM Service Portal" source="x_gmeps_itsm_servi">334ae627dbc85c105c1163901496192f</sys_package>
        <sys_policy/>
        <sys_scope display_value="ITSM Service Portal">334ae627dbc85c105c1163901496192f</sys_scope>
        <sys_update_name>sp_widget_76ef8adbdbb9d410fa11cf241496194d</sys_update_name>
        <sys_updated_by>renanlui</sys_updated_by>
        <sys_updated_on>2021-08-03 19:01:58</sys_updated_on>
        <template><![CDATA[  
  <div class="content_list col-md-12">

    <!-- Início do filtro Área -->
    <div class="col-md-2 filter-padding"> 
      <div ng-click="c.areaFilterState()" class="filter-click-size">
        <div class="title break-line-filter">{{data.areaFilterTitle}}
        </div>
        <img class="arrow-size" src="gservice_filter_dashboard_arrow.png" ng-class="c.data.showAreaFilter ? '' : 'invert-arrow'"/>
      </div>
      <div class="mask_filter">
        <div class="content_filters" ng-class="c.data.showAreaFilter ? 'filter_open' : 'filter_close'">
          <div class="list-properties" ng-repeat="areaFilter in data.filters.areaFilter">
            <div method="get" class="radio-properties">
              <label for="{{areaFilter.name}}" class="area_filter">
                <input type="checkbox"
                       id="{{areaFilter.name}}"
                       name="selectedItem"
                       value="{{areaFilter.name}}"
                       ng-model="areaFilter.selected"
                       ng-click="c.applyFilter(areaFilter, 'areaFilter'); c.statusFilterHide(areaFilter)">
                <div class="new-radio">
                  <span ng-class="areaFilter.selected ? 'radio-after' : ''"></span>
                </div>
                <div class="filter_name">{{areaFilter.name}}</div>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Fim do filtro Área -->

    <!-- Início do filtro Localidade -->
    <div class="col-md-2 filter-padding filter_location">
      <div ng-click="c.locationFilterState()" class="filter-click-size">
        <div class="title break-line-filter">{{data.locationFilterTitle}}
        </div>
        <img class="arrow-size" src="gservice_filter_dashboard_arrow.png" ng-class="c.data.showLocationFilter ? '' : 'invert-arrow'"/>
      </div>
      <div class="mask_filter">
        <div class="content_filters" ng-class="c.data.showLocationFilter ? 'filter_open' : 'filter_close'">
          <div class="list-properties" ng-repeat="locationFilter in data.filters.locationFilter">
            <div method="get" class="radio-properties">
              <label for="{{locationFilter.name}}" class="area_filter">
                <input type="checkbox"
                       id="{{locationFilter.name}}"
                       name="selectedItem"
                       value="{{locationFilter.name}}"
                       ng-model="locationFilter.selected"
                       ng-click="c.applyFilter(locationFilter, '')">
                <div class="new-radio">
                  <span ng-class="locationFilter.selected ? 'radio-after' : ''"></span>
                </div>
                <div class="filter_name">{{locationFilter.name}}</div>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Fim do filtro Localidade -->
    
    <!-- Início do filtro Pontos de Coleta -->
    <div class="col-md-2 filter-padding filter_location">
      <div ng-click="c.pontoDeColetaFilter()" class="filter-click-size">
        <div class="title break-line-filter">{{data.pontoDeColetaFilterTitle}}
        </div>
        <img class="arrow-size" src="gservice_filter_dashboard_arrow.png" ng-class="c.data.showPontoDeColetaFilter ? '' : 'invert-arrow'"/>
      </div>
      <div class="mask_filter">
        <div class="content_filters" ng-class="c.data.showPontoDeColetaFilter ? 'filter_open' : 'filter_close'">
          <div class="list-properties" ng-repeat="pontoDeColetaFilter in data.filters.pontoDeColetaFilter">
            <div method="get" class="radio-properties">
              <label for="{{pontoDeColetaFilter.name}}" class="area_filter">
                <input type="checkbox"
                       id="{{pontoDeColetaFilter.name}}"
                       name="selectedItem"
                       value="{{pontoDeColetaFilter.name}}"
                       ng-model="pontoDeColetaFilter.selected"
                       ng-click="c.applyFilter(pontoDeColetaFilter, 'pontoDeColetaFilter')">
                <div class="new-radio">
                  <span ng-class="pontoDeColetaFilter.selected ? 'radio-after' : ''"></span>
                </div>
                <div class="filter_name">{{pontoDeColetaFilter.name}}</div>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Fim do filtro Pontos de Coleta -->

    <!-- Início do filtro Status -->
    <div class="col-md-2 filter-padding">
      <div ng-click="c.statusFilterState()" class="filter-click-size">
        <div class="title break-line-filter">{{data.statusFilterTitle}}
        </div>
        <img class="arrow-size" src="gservice_filter_dashboard_arrow.png" ng-class="c.data.showStatusFilter ? '' : 'invert-arrow'"/>
      </div>
      <div class="mask_filter">
        <div class="content_filters" ng-class="c.data.showStatusFilter ? 'filter_open' : 'filter_close'">
          <div class="list-properties" ng-repeat="statusFilter in data.filters.statusFilter">
            <div method="get" class="radio-properties">
              <label for="{{statusFilter.name}}" class="area_filter">
                <input type="checkbox"
                       id="{{statusFilter.name}}"
                       name="selectedItem"
                       value="{{statusFilter.name}}"
                       ng-model="statusFilter.selected"
                       ng-click="c.applyFilter(statusFilter, 'statusFilter')">
                <div class="new-radio">
                  <span ng-class="statusFilter.selected ? 'radio-after' : ''"></span>
                </div>
                <div class="filter_name">{{statusFilter.name}}</div>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Fim do filtro Status -->

    <sp-widget widget="data.typeaheadWidget" ng-click="c.getSearchTerm()"></sp-widget>
  </div>
  
]]></template>
    </sp_widget>
</record_update>
